---
title: "Find historical milestones from cited references"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{milestones}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(CRMilestones)
```

### Motivation

Intro text, motivation, context, links to references.

### CRExplorer

This package uses CRExplorer, which is free and available from https://andreas-thor.github.io/cre/. A manual to the software can be found here: https://andreas-thor.github.io/cre/manual.pdf.

To use this package, you need a copy of CRExplorer. One is bundled in the package (version 1.9, downloaded in June/2021) and is the default option. If you want to use your own installation, you'll need to pass the path to the function calls below.

### Optogenetics

Example data, maybe redo the search from their paper?
Below it's run with default arguments, but you can change them.
```{r}
wos_records = system.file("extdata", "optogenetics.txt", package = "CRMilestones", mustWork = T)
CR_data = run_CRE(data_files = wos_records)
```

It returns the graph data, absolute and already de-trended (see ...). It also returns the data frame with the list of references, already disambiguated (optionally, it should save the files in CSV or WOS) and the RPYS plot (like the one in the software).

If you want the graphs, you can plot them:
```{r}
plot_rpys(CR_data)
```

```{r}
plot_multi_rpys(CR_data)
```


Now you just run the analysis to identify the peak years and references (Tukey HSD?)
```{r}
milestones = identify_milestones(CR_data, n_milestones = 10, n_refs = 1)
```

Returns then a list of milestone references, the list of peak years and the RPYS plot, but indicating peaks with vertical lines and it's done.
```{r}
head(milestones$pubs)
```

```{r}
milestones$graph
```

